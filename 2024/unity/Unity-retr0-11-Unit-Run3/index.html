<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>[Unity] 2D 러너 게임 | Sangjjangit</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="[Unity] 2D 러너 게임" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="발판 반복 생성/마무리" />
<meta property="og:description" content="발판 반복 생성/마무리" />
<link rel="canonical" href="/2024/unity/Unity-retr0-11-Unit-Run3/" />
<meta property="og:url" content="/2024/unity/Unity-retr0-11-Unit-Run3/" />
<meta property="og:site_name" content="Sangjjangit" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-10-13T10:47:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="[Unity] 2D 러너 게임" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-10-13T10:47:00+00:00","datePublished":"2024-10-13T10:47:00+00:00","description":"발판 반복 생성/마무리","headline":"[Unity] 2D 러너 게임","mainEntityOfPage":{"@type":"WebPage","@id":"/2024/unity/Unity-retr0-11-Unit-Run3/"},"url":"/2024/unity/Unity-retr0-11-Unit-Run3/"}</script>
<!-- End Jekyll SEO tag -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sangjjangit</title>
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/nav-menu.css">
    <link rel="stylesheet" href="/assets/css/md2.css">
    <link rel="stylesheet" href="/assets/css/post-list.css">
    <link rel="stylesheet" href="/assets/css/syntax.css">
    <!-- <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script> -->

    <!-- site-search -->
    <meta name="google-site-verification" content="hOqiLm-b8Xc-VENt1dN1OpAvI2gWGwlr6lcboTsAJVg" />
    <meta name="naver-site-verification" content="37d97b6c4072831a48f456a7704a79f5d8aee979" />

    <!-- google-adsense -->
    <meta name="google-adsense-account" content="ca-pub-8541064564180007">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8541064564180007"
     crossorigin="anonymous"></script>
</head>
<body>
<header>
    <h1>
        <a href="/">Sangjjangit</a>
    </h1>
    <small>요약/실습</small>
<!--    <p>summy reading books</p>-->
    <nav>
        <ul class="nav-menu">
            
            <li><a href="/">All</a></li>
            
            <li><a href="/category/Unity/">Unity</a></li>
            
            <li><a href="/category/Blender/">Blender</a></li>
            
        </ul>
    </nav>
</header>

<main>
    <article>
    <h1>[Unity] 2D 러너 게임</h1>
    <p><em>Posted on 2024-10-13 10:47:00</em></p>
    <div>
        <h3 id="유니런-2d-게임">유니런 2D 게임</h3>

<ul>
  <li>예제소스 : <a href="https://github.com/IJEMIN/Unity-Programming-Essence-2021">https://github.com/IJEMIN/Unity-Programming-Essence-2021</a></li>
  <li>예제번호 : 11, 12, 13</li>
  <li>씬과 코드는 를 제외한 모든 에엣은 준비된 상태에서 코딩과 기능 구현에 집중한다.</li>
</ul>

<h3 id="발판">발판</h3>
<ul>
  <li>프로젝트 창 &gt; Prefabs 폴더의 Platform 프리팹을 하이어라키 창으로 드래그앤드랍</li>
  <li>하이어라키 창에 생성된 Platform 오브젝트 인스펙터 창
    <ul>
      <li>Sprite Renderer 컴포넌트의 Sorting Layer를 Foreground 변경</li>
    </ul>
  </li>
  <li>하이어라키 창에 생성된 Platform 오브젝트의 자식 오브젝트 선택(Shift + 클릭)</li>
  <li>Platform 오브젝트의 자식 오브젝트 인스펙터 창
    <ul>
      <li>Sprite Renderer 컴포넌트의 Sorting Layer를 Middleground 변경</li>
    </ul>
  </li>
  <li>프로젝트 창에 Scripts 폴더 &gt; Platform 스크립트를 하이어라키 창의 Platform 오브젝트로 드래그앤드랍</li>
  <li>Platform 스크립트
    <div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="cm">/** */</span>
<span class="c1">// 발판으로서 필요한 동작을 담은 스크립트</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">Platform</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>
  <span class="k">public</span> <span class="n">GameObject</span><span class="p">[]</span> <span class="n">obstacles</span><span class="p">;</span> <span class="c1">// 장애물 오브젝트들</span>
  <span class="k">private</span> <span class="kt">bool</span> <span class="n">stepped</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span> <span class="c1">// 플레이어 캐릭터가 밟았었는가</span>

  <span class="c1">// 컴포넌트가 활성화될때 마다 매번 실행되는 메서드</span>
  <span class="c1">// 유니티 이벤트 메서드</span>
  <span class="c1">// 컴포넌트가 활성화될때마다 실행된다.</span>
  <span class="k">private</span> <span class="k">void</span> <span class="nf">OnEnable</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// 발판을 리셋하는 처리</span>
      <span class="n">stepped</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">obstacles</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++){</span>
          <span class="k">if</span><span class="p">(</span><span class="n">Random</span><span class="p">.</span><span class="nf">Range</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">)</span> <span class="p">==</span> <span class="m">0</span><span class="p">){</span> <span class="c1">// 1/3의 확률</span>
              <span class="n">obstacles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
          <span class="p">}</span><span class="k">else</span><span class="p">{</span>
              <span class="n">obstacles</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
          <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">void</span> <span class="nf">OnCollisionEnter2D</span><span class="p">(</span><span class="n">Collision2D</span> <span class="n">collision</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// 플레이어 캐릭터가 자신을 밟았을때 점수를 추가하는 처리</span>
      <span class="k">if</span><span class="p">(</span><span class="n">collision</span><span class="p">.</span><span class="n">collider</span><span class="p">.</span><span class="n">tag</span> <span class="p">==</span> <span class="s">"Player"</span> <span class="p">&amp;&amp;</span> <span class="p">!</span><span class="n">stepped</span><span class="p">){</span>
          <span class="n">stepped</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
          <span class="n">GameManager</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="nf">AddScore</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>하이어라키 창에 Platform 오브젝트의 인스펙트 창
    <ul>
      <li>Platform 컴포넌트의 Obstacles 배열크기 3 변경 &gt; Obstacles 펼치기</li>
      <li>하이어라키 창에 Platform 오브젝트의 자식 오브젝트를 할당</li>
    </ul>
  </li>
  <li>Platform 프리팹 갱신</li>
  <li>하이어라키 창에 Platform 오브젝트의 인스펙트 창
    <ul>
      <li>Overrides &gt; Apply All 클릭</li>
    </ul>
  </li>
  <li>하이어라키 창에 Platform 오브젝트 삭제(Delete)</li>
</ul>

<h3 id="발판-생성기">발판 생성기</h3>
<ul>
  <li>오브젝트 폴링 방식</li>
  <li>3개의 발판 오브젝트를 미리 생성 및 보이지 않는 곳에 배치</li>
  <li>일정 시간 후 발판을 리셋하고 재배치</li>
  <li>PlatformSpawner 스크립트</li>
  <li>하이어라키 창에 + &gt; Create Empty</li>
  <li>생성한 빈 게임 오브젝트의 인스펙트 창
    <ul>
      <li>이름: Platform Spawner</li>
    </ul>
  </li>
  <li>프로젝트 창에 Scripts 폴더 &gt; PlatformSpawner 스크립트를 하이어라키 창의 Platform Spawner 오브젝트로 드래그앤드랍</li>
  <li>PlatformSpawner 스크립트 더블 클릭
    <div class="language-c# highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="cm">/** */</span>
<span class="c1">// 발판을 생성하고 주기적으로 재배치하는 스크립트</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">PlatformSpawner</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>
  <span class="k">public</span> <span class="n">GameObject</span> <span class="n">platformPrefab</span><span class="p">;</span> <span class="c1">// 생성할 발판의 원본 프리팹</span>
  <span class="k">public</span> <span class="kt">int</span> <span class="n">count</span> <span class="p">=</span> <span class="m">3</span><span class="p">;</span> <span class="c1">// 생성할 발판의 개수</span>

  <span class="k">public</span> <span class="kt">float</span> <span class="n">timeBetSpawnMin</span> <span class="p">=</span> <span class="m">1.25f</span><span class="p">;</span> <span class="c1">// 다음 배치까지의 시간 간격 최솟값</span>
  <span class="k">public</span> <span class="kt">float</span> <span class="n">timeBetSpawnMax</span> <span class="p">=</span> <span class="m">2.25f</span><span class="p">;</span> <span class="c1">// 다음 배치까지의 시간 간격 최댓값</span>
  <span class="k">private</span> <span class="kt">float</span> <span class="n">timeBetSpawn</span><span class="p">;</span> <span class="c1">// 다음 배치까지의 시간 간격</span>

  <span class="k">public</span> <span class="kt">float</span> <span class="n">yMin</span> <span class="p">=</span> <span class="p">-</span><span class="m">3.5f</span><span class="p">;</span> <span class="c1">// 배치할 위치의 최소 y값</span>
  <span class="k">public</span> <span class="kt">float</span> <span class="n">yMax</span> <span class="p">=</span> <span class="m">1.5f</span><span class="p">;</span> <span class="c1">// 배치할 위치의 최대 y값</span>
  <span class="k">private</span> <span class="kt">float</span> <span class="n">xPos</span> <span class="p">=</span> <span class="m">20f</span><span class="p">;</span> <span class="c1">// 배치할 위치의 x 값</span>

  <span class="k">private</span> <span class="n">GameObject</span><span class="p">[]</span> <span class="n">platforms</span><span class="p">;</span> <span class="c1">// 미리 생성한 발판들</span>
  <span class="k">private</span> <span class="kt">int</span> <span class="n">currentIndex</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="c1">// 사용할 현재 순번의 발판</span>

  <span class="k">private</span> <span class="n">Vector2</span> <span class="n">poolPosition</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="p">-</span><span class="m">25</span><span class="p">);</span> <span class="c1">// 초반에 생성된 발판들을 화면 밖에 숨겨둘 위치</span>
  <span class="k">private</span> <span class="kt">float</span> <span class="n">lastSpawnTime</span><span class="p">;</span> <span class="c1">// 마지막 배치 시점</span>


  <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// 변수들을 초기화하고 사용할 발판들을 미리 생성</span>
      <span class="n">platforms</span> <span class="p">=</span> <span class="k">new</span> <span class="n">GameObject</span><span class="p">[</span><span class="n">count</span><span class="p">];</span>
      <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="n">i</span><span class="p">++){</span>
          <span class="n">platforms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">=</span> <span class="nf">Instantiate</span><span class="p">(</span><span class="n">platformPrefab</span><span class="p">,</span> <span class="n">poolPosition</span><span class="p">,</span> <span class="n">Quaternion</span><span class="p">.</span><span class="n">identity</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="n">lastSpawnTime</span> <span class="p">=</span> <span class="m">0f</span><span class="p">;</span>
      <span class="n">timeBetSpawn</span> <span class="p">=</span> <span class="m">0f</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">void</span> <span class="nf">Update</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// 순서를 돌아가며 주기적으로 발판을 배치</span>
      <span class="k">if</span><span class="p">(</span><span class="n">GameManager</span><span class="p">.</span><span class="n">instance</span><span class="p">.</span><span class="n">isGameover</span><span class="p">){</span>
          <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">if</span><span class="p">(</span><span class="n">Time</span><span class="p">.</span><span class="n">time</span> <span class="p">&gt;=</span> <span class="n">lastSpawnTime</span> <span class="p">+</span> <span class="n">timeBetSpawn</span><span class="p">){</span>
          <span class="n">lastSpawnTime</span> <span class="p">=</span> <span class="n">Time</span><span class="p">.</span><span class="n">time</span><span class="p">;</span>
          <span class="n">timeBetSpawn</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="nf">Range</span><span class="p">(</span><span class="n">timeBetSpawnMin</span><span class="p">,</span> <span class="n">timeBetSpawnMax</span><span class="p">);</span>
          <span class="kt">float</span> <span class="n">yPos</span> <span class="p">=</span> <span class="n">Random</span><span class="p">.</span><span class="nf">Range</span><span class="p">(</span><span class="n">yMin</span><span class="p">,</span> <span class="n">yMax</span><span class="p">);</span>
          <span class="n">platforms</span><span class="p">[</span><span class="n">currentIndex</span><span class="p">].</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
          <span class="n">platforms</span><span class="p">[</span><span class="n">currentIndex</span><span class="p">].</span><span class="nf">SetActive</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
          <span class="n">platforms</span><span class="p">[</span><span class="n">currentIndex</span><span class="p">].</span><span class="n">transform</span><span class="p">.</span><span class="n">position</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Vector2</span><span class="p">(</span><span class="n">xPos</span><span class="p">,</span> <span class="n">yPos</span><span class="p">);</span>
          <span class="n">currentIndex</span><span class="p">++;</span>

          <span class="k">if</span><span class="p">(</span><span class="n">currentIndex</span> <span class="p">&gt;=</span> <span class="n">count</span><span class="p">){</span>
              <span class="n">currentIndex</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
          <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>하이어라키 창에 Platform Spawner 오브젝트의 인스펙터 창
    <ul>
      <li>프로젝트 창에 Prefabs 폴더 &gt; Platform 프리팹을 PlatformSpawner 컴포넌트의 Platform Prefab 필드로 드래그앤드랍</li>
    </ul>
  </li>
  <li>배경음악 추가</li>
  <li>프로젝트 창에 Audio 폴더 &gt; music 오디오 클립을 하이어라키 창으로 드래그앤드랍</li>
  <li>생성된 music 오브젝트의 인스펙터 창
    <ul>
      <li>Audio Source 컴포넌트의 Loop 체크</li>
    </ul>
  </li>
</ul>

<h3 id="빌드하기">빌드하기</h3>
<ul>
  <li>빌드 설정 창 열기(상단메뉴 File &gt; Build Settings..)</li>
  <li>빌드 설정 창에서 Add Open Scenes 클릭</li>
  <li>Build and Run 클릭</li>
  <li>탐색 창에서 빌드를 저장할 폴더 선택</li>
  <li>
    <p>Save 클릭</p>
  </li>
  <li>테스트.끝</li>
</ul>

<p><a href="https://youtu.be/UpxK7G0G6oE" target="_blank"><img src="https://img.youtube.com/vi/UpxK7G0G6oE/0.jpg" alt="테스트" /></a></p>

<hr />

    </div>
    
    <div class="back-to-home">
        <!-- <a href="/">Back to Home</a> -->
        <a href="javascript:window.history.back();">Back to Previous Page</a>
    </div>
</article>
</main>

<footer>
    <p>&copy; 2024 Sangjjangit</p>
</footer>
</body>
</html>